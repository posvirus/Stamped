import{_ as se,r as m,c as k,o as de,a as he,b as te,d as me,w as fe,e as c,f as D,g as e,h as O,t as N,i as re,n as ie,j as z,T as ke,k as Ce,u as we,l as r,m as j,p as pe,q as f,s as be,v as Te,x as _e,F as J,y as Q,z as ce,A as ue}from"./index-BPoUppka.js";const xe="data:image/svg+xml,%3csvg%20width='28'%20height='28'%20viewBox='0%200%2028%2028'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='-0.000244141'%20width='28'%20height='28'%20rx='14'%20fill='%23FFEDD5'/%3e%3cpath%20d='M11.9998%206C9.23833%206%206.99976%208.23858%206.99976%2011V23H8.99976V16H13.5855L15.5855%2018H16.9998C19.7612%2018%2021.9998%2015.7614%2021.9998%2013C21.9998%2010.2386%2019.7612%208%2016.9998%208H16.414L14.414%206H11.9998Z'%20fill='%23EF8834'/%3e%3c/svg%3e",Le="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2030%2030'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='-0.000244141'%20width='30'%20height='30'%20rx='15'%20fill='%23F0F2E8'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M17.1717%205.76544C16.2068%204.09267%2013.7925%204.09267%2012.8276%205.76544C12.2602%206.74914%2011.1025%207.22868%2010.0057%206.93433C8.14055%206.4338%206.43343%208.14091%206.93397%2010.006C7.22831%2011.1029%206.74878%2012.2606%205.76508%2012.828C4.0923%2013.7929%204.0923%2016.2071%205.76508%2017.172C6.74878%2017.7395%207.22831%2018.8972%206.93397%2019.994C6.43343%2021.8591%208.14055%2023.5662%2010.0057%2023.0657C11.1025%2022.7713%2012.2602%2023.2509%2012.8276%2024.2346C13.7925%2025.9074%2016.2068%2025.9074%2017.1717%2024.2346C17.7391%2023.2509%2018.8968%2022.7713%2019.9936%2023.0657C21.8587%2023.5662%2023.5659%2021.8591%2023.0653%2019.994C22.771%2018.8972%2023.2505%2017.7395%2024.2342%2017.172C25.907%2016.2071%2025.907%2013.7929%2024.2342%2012.828C23.2505%2012.2606%2022.771%2011.1029%2023.0653%2010.006C23.5659%208.14092%2021.8587%206.4338%2019.9936%206.93433C18.8968%207.22868%2017.7391%206.74914%2017.1717%205.76544ZM15.6886%2017.9756L20.7237%2012.6897L19.2756%2011.3103L14.2405%2016.5961C14.002%2016.8465%2013.8401%2016.9181%2013.5709%2016.9743C13.3242%2017.0258%2013.0679%2016.9999%2012.8322%2016.8974C12.5958%2016.7946%2012.3859%2016.617%2012.2347%2016.3794C12.0832%2016.1414%2011.9996%2015.8567%2011.9996%2015.5618H9.99965C9.99965%2016.2313%2010.1885%2016.8894%2010.5475%2017.4533C10.9067%2018.0177%2011.4222%2018.4651%2012.0346%2018.7315C12.6477%2018.9981%2013.3254%2019.0687%2013.9797%2018.932C14.6117%2018.8001%2015.1472%2018.544%2015.6886%2017.9756Z'%20fill='%239BB167'/%3e%3c/svg%3e",$e={key:0,class:"toast__icon"},De={key:0,viewBox:"0 0 24 24",class:"toast__icon-svg"},Se={key:1,viewBox:"0 0 24 24",class:"toast__icon-svg"},Me={key:2,viewBox:"0 0 24 24",class:"toast__icon-svg"},Pe={key:3,viewBox:"0 0 24 24",class:"toast__icon-svg"},Ae={key:4,viewBox:"0 0 24 24",class:"toast__icon-svg toast__icon-loading"},Be={class:"toast__content"},Re={key:0,class:"toast__title"},Ne={class:"toast__message"},Ie={key:2,class:"toast__progress"},Ee=Object.assign({inheritAttrs:!1},{__name:"Toast",props:{type:{type:String,default:"info",validator:i=>["success","error","warning","info","loading"].includes(i)},message:{type:String,required:!0},title:{type:String,default:""},position:{type:String,default:"top-center",validator:i=>["top-left","top-center","top-right","middle-left","middle-center","middle-right","bottom-left","bottom-center","bottom-right"].includes(i)},duration:{type:Number,default:3e3},showIcon:{type:Boolean,default:!0},closable:{type:Boolean,default:!1},showProgress:{type:Boolean,default:!1},clickToClose:{type:Boolean,default:!1},customClass:{type:[String,Array,Object],default:""},offset:{type:[String,Number],default:20}},emits:["close","click"],setup(i,{expose:$,emit:a}){we(d=>({"543d0e08":`${i.offset}px`}));const s=i,y=a,v=m(!0),C=m(100);let p=null;const w=k(()=>[`toast--${s.type}`,`toast--${s.position}`,{"toast--with-title":s.title,"toast--closable":s.closable,"toast--clickable":s.clickToClose},s.customClass]),b=k(()=>({width:`${C.value}%`,transition:s.duration>0?`width ${s.duration}ms linear`:"none"})),h=()=>{v.value=!1,S(),setTimeout(()=>{y("close")},300)},g=()=>{y("click"),s.clickToClose&&h()},_=()=>{s.duration>0&&s.type!=="loading"&&(p=setTimeout(()=>{h()},s.duration),s.showProgress&&(C.value=0))},S=()=>{p&&(clearTimeout(p),p=null)};return de(()=>{_()}),he(()=>{S()}),$({close:h}),(d,o)=>(r(),te(Ce,{to:"body"},[me(ke,{name:"toast",appear:""},{default:fe(()=>[v.value?(r(),c("div",{key:0,class:z(["toast",w.value]),onClick:g},[i.showIcon?(r(),c("div",$e,[O(d.$slots,"icon",{},()=>[i.type==="success"?(r(),c("svg",De,o[0]||(o[0]=[e("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"},null,-1)]))):i.type==="error"?(r(),c("svg",Se,o[1]||(o[1]=[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"},null,-1)]))):i.type==="warning"?(r(),c("svg",Me,o[2]||(o[2]=[e("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"},null,-1)]))):i.type==="info"?(r(),c("svg",Pe,o[3]||(o[3]=[e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"},null,-1)]))):i.type==="loading"?(r(),c("svg",Ae,o[4]||(o[4]=[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-dasharray":"31.416","stroke-dashoffset":"31.416"},[e("animate",{attributeName:"stroke-dasharray",dur:"2s",values:"0 31.416;15.708 15.708;0 31.416",repeatCount:"indefinite"}),e("animate",{attributeName:"stroke-dashoffset",dur:"2s",values:"0;-15.708;-31.416",repeatCount:"indefinite"})],-1)]))):D("",!0)],!0)])):D("",!0),e("div",Be,[i.title?(r(),c("div",Re,N(i.title),1)):D("",!0),e("div",Ne,[O(d.$slots,"default",{},()=>[j(N(i.message),1)],!0)])]),i.closable?(r(),c("button",{key:1,class:"toast__close",onClick:re(h,["stop"]),"aria-label":"关闭"},o[5]||(o[5]=[e("svg",{viewBox:"0 0 24 24",class:"toast__close-icon"},[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)]))):D("",!0),i.showProgress&&i.duration>0?(r(),c("div",Ie,[e("div",{class:"toast__progress-bar",style:ie(b.value)},null,4)])):D("",!0)],2)):D("",!0)]),_:3})]))}}),He=se(Ee,[["__scopeId","data-v-c886143d"]]);function ze(i={}){const{refreshThreshold:$=80,loadThreshold:a=100,damping:s=.5,maxPullDistance:y=120,disabled:v=!1,enablePullRefresh:C=!0,enableLoadMore:p=!0,autoResetTime:w=1e3}=i,b=m(!1),h=m(!1),g=m(!1),_=m(0),S=m(0),d=m(!0),o=m("idle"),T=m("idle"),A=m(0),M=m(0),E=m(!1),P=m(null),H={refresh:{idle:"下拉刷新",pulling:"下拉刷新",ready:"释放刷新",refreshing:"正在刷新...",success:"刷新成功",error:"刷新失败"},load:{idle:"上拉加载更多",loading:"正在加载...",success:"加载成功",error:"加载失败",nomore:"没有更多数据"}},V=m(null),Y=m(null),x=()=>!C||v||h.value||g.value?!1:P.value?P.value.scrollTop<=0:window.scrollY<=0,L=()=>{if(!p||v||h.value||g.value||!d.value)return!1;if(P.value){const{scrollTop:X,scrollHeight:ge,clientHeight:ye}=P.value;return ge-X-ye<=a}const{scrollY:u,innerHeight:R}=window,{scrollHeight:W}=document.documentElement;return W-u-R<=a},B=u=>{if(v)return;const R=u.touches[0];A.value=R.clientY,M.value=R.clientY,E.value=!0,b.value=!1},K=u=>{if(!E.value||v)return;const R=u.touches[0];M.value=R.clientY;const W=M.value-A.value;if(W>0&&x()){u.preventDefault(),b.value=!0;const X=Math.min(W*s,y);_.value=X,X>=$?o.value="ready":o.value="pulling"}},ae=()=>{!E.value||v||(E.value=!1,b.value&&_.value>=$&&!h.value?G():q(),b.value=!1)},G=async()=>{if(!(h.value||!V.value)){h.value=!0,o.value="refreshing",_.value=$;try{await V.value(),o.value="success",setTimeout(()=>{q()},w)}catch(u){o.value="error",console.error("刷新失败:",u),setTimeout(()=>{q()},w)}}},Z=async()=>{if(!(g.value||!Y.value||!d.value)){g.value=!0,T.value="loading";try{await Y.value()===!1?(d.value=!1,T.value="nomore"):T.value="success"}catch(u){T.value="error",console.error("加载失败:",u)}finally{g.value=!1,T.value!=="nomore"&&setTimeout(()=>{T.value="idle"},w)}}},q=()=>{_.value=0,h.value=!1,o.value="idle"},oe=()=>{g.value=!1,T.value="idle",d.value=!0},F=()=>{v||!p||L()&&!g.value&&d.value&&Z()},le=()=>H.refresh[o.value]||H.refresh.idle,U=()=>H.load[T.value]||H.load.idle,ne=()=>{!v&&!h.value&&G()},l=()=>{!v&&!g.value&&d.value&&Z()},t=u=>{P.value=u},n=()=>{const u=P.value||window;u===window?window.addEventListener("scroll",F,{passive:!0}):u.addEventListener("scroll",F,{passive:!0})},I=()=>{const u=P.value||window;u===window?window.removeEventListener("scroll",F):u.removeEventListener("scroll",F)};return de(()=>{pe(()=>{n()})}),he(()=>{I()}),{isPulling:b,isRefreshing:h,isLoading:g,pullDistance:_,loadDistance:S,canLoadMore:d,refreshStatus:o,loadStatus:T,handleTouchStart:B,handleTouchMove:K,handleTouchEnd:ae,handleScroll:F,manualRefresh:ne,manualLoadMore:l,resetPullState:q,resetLoadState:oe,setContainer:t,getRefreshText:le,getLoadText:U,setOnRefresh:u=>{V.value=u},setOnLoadMore:u=>{Y.value=u},setCanLoadMore:u=>{d.value=u},refreshThreshold:$,maxPullDistance:y}}const Ve={class:"pull-refresh-content"},Ye={class:"pull-refresh-text"},Fe={class:"load-more-content"},Oe={class:"load-more-text"},qe={__name:"PullRefresh",props:{disabled:{type:Boolean,default:!1},enablePullRefresh:{type:Boolean,default:!0},enableLoadMore:{type:Boolean,default:!0},refreshThreshold:{type:Number,default:80},maxPullDistance:{type:Number,default:120},damping:{type:Number,default:.5},canLoadMore:{type:Boolean,default:!0},autoResetTime:{type:Number,default:1e3}},emits:["refresh","load-more"],setup(i,{expose:$,emit:a}){const s=i,y=a,v=m(null),{isRefreshing:C,isLoading:p,pullDistance:w,refreshStatus:b,loadStatus:h,handleTouchStart:g,handleTouchMove:_,handleTouchEnd:S,getRefreshText:d,getLoadText:o,setOnRefresh:T,setOnLoadMore:A,setCanLoadMore:M,setContainer:E}=ze({refreshThreshold:s.refreshThreshold,maxPullDistance:s.maxPullDistance,damping:s.damping,disabled:s.disabled,enablePullRefresh:s.enablePullRefresh,enableLoadMore:s.enableLoadMore,autoResetTime:s.autoResetTime}),P=k(()=>{const x=Math.min(w.value,s.maxPullDistance);return{transform:`translateY(${x-s.refreshThreshold}px)`,opacity:Math.min(x/s.refreshThreshold,1)}}),H=k(()=>C.value?{transform:`translateY(${s.refreshThreshold}px)`,transition:"transform 0.3s ease"}:w.value>0?{transform:`translateY(${Math.min(w.value,s.maxPullDistance)}px)`}:{}),V=k(()=>s.enableLoadMore&&(p.value||h.value!=="idle"));T(async()=>{await y("refresh")}),A(async()=>await y("load-more")!==!1);const Y=x=>{M(x)};return pe(()=>{E(v.value),Y(s.canLoadMore)}),$({manualRefresh:()=>T,manualLoadMore:()=>A,resetPullState:()=>{},resetLoadState:()=>{}}),(x,L)=>(r(),c("div",{class:z(["pull-refresh-container",{"pull-refresh-container--disabled":i.disabled}]),onTouchstart:L[0]||(L[0]=(...B)=>f(g)&&f(g)(...B)),onTouchmove:L[1]||(L[1]=(...B)=>f(_)&&f(_)(...B)),onTouchend:L[2]||(L[2]=(...B)=>f(S)&&f(S)(...B)),ref_key:"containerRef",ref:v},[e("div",{class:z(["pull-refresh-indicator",[`pull-refresh-indicator--${f(b)}`,{"pull-refresh-indicator--visible":f(w)>0||f(C)}]]),style:ie(P.value)},[e("div",Ve,[e("div",{class:z(["pull-refresh-icon",{"pull-refresh-icon--spinning":f(C)}])},[O(x.$slots,"refresh-icon",{},()=>[L[3]||(L[3]=e("svg",{viewBox:"0 0 24 24",class:"default-refresh-icon"},[e("path",{d:"M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"})],-1))])],2),e("div",Ye,[O(x.$slots,"refresh-text",{status:f(b),text:f(d)()},()=>[j(N(f(d)()),1)])])])],6),e("div",{class:"pull-refresh-content-wrapper",style:ie(H.value)},[O(x.$slots,"default",{},void 0)],4),i.enableLoadMore?(r(),c("div",{key:0,class:z(["load-more-indicator",[`load-more-indicator--${f(h)}`,{"load-more-indicator--visible":V.value}]])},[e("div",Fe,[e("div",{class:z(["load-more-icon",{"load-more-icon--spinning":f(p)}])},[O(x.$slots,"load-icon",{},()=>[L[4]||(L[4]=e("svg",{viewBox:"0 0 24 24",class:"default-load-icon"},[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-dasharray":"31.416","stroke-dashoffset":"31.416"},[e("animate",{attributeName:"stroke-dasharray",dur:"2s",values:"0 31.416;15.708 15.708;0 31.416",repeatCount:"indefinite"}),e("animate",{attributeName:"stroke-dashoffset",dur:"2s",values:"0;-15.708;-31.416",repeatCount:"indefinite"})])],-1))])],2),e("div",Oe,[O(x.$slots,"load-text",{status:f(h),text:f(o)()},()=>[j(N(f(o)()),1)])])])],2)):D("",!0)],34))}},Ue=se(qe,[["__scopeId","data-v-650d42a0"]]),Ze="/assets/acc-X761K81-.svg",je=["aria-label"],Ke={class:"task-card__header"},Ge={class:"task-card__title"},We={class:"task-card__actions"},Xe={key:0,class:"task-card__status"},Je={class:"task-card__meta"},Qe={class:"task-card__date"},et={class:"task-card__agreement-preview"},tt={key:0,class:"task-card__description"},st={__name:"TaskCard",props:{title:{type:String,required:!0},description:{type:String,default:""},createdAt:{type:[String,Date],required:!0},completedAt:{type:[String,Date],default:null},isCompleted:{type:Boolean,default:!1},showType:{type:Boolean,default:!0},showDescription:{type:Boolean,default:!1},maxTitleLength:{type:Number,default:20},showDeleteButton:{type:Boolean,default:!1},taskId:{type:[String,Number],default:null}},emits:["click","longpress","delete"],setup(i,{emit:$}){const a=i,s=$,y=k(()=>{const d=a.isCompleted?4:6;return a.title.length<=d?a.title:a.title.substring(0,d)+"..."}),v=k(()=>S(a.createdAt)),C=k(()=>a.completedAt?S(a.completedAt):""),p=k(()=>{if(!a.description)return"";const d=12;return a.description.length<=d?a.description:a.description.substring(0,d)+"..."}),w=()=>{s("click",{_id:a.taskId,title:a.title,description:a.description,createdAt:a.createdAt,completedAt:a.completedAt,isCompleted:a.isCompleted})},b=d=>{d.preventDefault(),d.stopPropagation(),s("delete",{_id:a.taskId,title:a.title,description:a.description,createdAt:a.createdAt,completedAt:a.completedAt,isCompleted:a.isCompleted})};let h=0;const g=d=>{h=Date.now(),d.currentTarget.classList.add("task-card--touching")},_=d=>{const o=Date.now()-h;d.currentTarget.classList.remove("task-card--touching"),o>500&&s("longpress",{_id:a.taskId,title:a.title,description:a.description,createdAt:a.createdAt,completedAt:a.completedAt,isCompleted:a.isCompleted})},S=d=>{const o=new Date(d),A=new Date-o,M=Math.floor(A/(1e3*60*60*24));return M===0?"今天":M===1?"昨天":M<7?`${M}天前`:o.toLocaleDateString("zh-CN",{month:"numeric",day:"numeric"})};return(d,o)=>(r(),c("div",{class:z(["task-card",{"task-card--completed":i.isCompleted}]),onClick:w,onTouchstart:g,onTouchend:_,onTouchcancel:_,tabindex:"0",role:"button","aria-label":`任务: ${i.title}`},[e("div",Ke,[e("h3",Ge,N(y.value),1),e("div",We,[i.isCompleted?(r(),c("div",Xe,o[2]||(o[2]=[e("img",{src:Ze,alt:"已完成",class:"task-card__stamp-icon"},null,-1)]))):D("",!0),i.showDeleteButton?(r(),c("button",{key:1,class:"task-card__delete-btn",onClick:b,onTouchstart:o[0]||(o[0]=re(()=>{},["stop"])),onTouchend:o[1]||(o[1]=re(()=>{},["stop"])),"aria-label":"删除任务",title:"删除任务",type:"button"},o[3]||(o[3]=[e("svg",{viewBox:"0 0 24 24",class:"task-card__delete-icon"},[e("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})],-1)]),32)):D("",!0)])]),e("div",Je,[e("span",Qe,N(i.isCompleted?`完成于 ${C.value}`:`创建于 ${v.value}`),1),e("span",et,N(p.value),1)]),i.description&&i.showDescription?(r(),c("div",tt,[e("p",null,N(i.description),1)])):D("",!0)],42,je))}},ve=se(st,[["__scopeId","data-v-c04a8885"]]),at={class:"home-page"},ot={class:"main-content"},lt={class:"task-sections"},nt={class:"calendar-widget"},rt={class:"calendar-week"},it={class:"calendar-dates"},dt={class:"task-carousel-section"},ct={class:"section-header"},ut={class:"search-bar"},vt={class:"task-carousel"},ht={key:0,class:"empty-state"},mt={key:0,class:"search-empty"},ft={key:1},pt={key:1,class:"task-carousel-with-nav"},gt=["disabled"],yt={class:"task-cards"},kt=["disabled"],Ct={class:"task-carousel-section"},wt={class:"section-header"},bt={class:"search-bar"},Tt={class:"task-carousel"},_t={key:0,class:"empty-state"},xt={key:0,class:"search-empty"},Lt={key:1},$t={key:1,class:"task-carousel-with-nav"},Dt=["disabled"],St={class:"task-cards"},Mt=["disabled"],Pt={class:"bottom-nav-bar"},At={class:"nav-button-group left"},Bt={class:"nav-button-group right"},ee=2,Rt={__name:"HomePage",setup(i){const $=_e(),a=be(),s=Te(),y=m(0),v=m(0),C=m(""),p=m(""),w=m(1),b=m(!0),h=k(()=>{const l=a.pendingTasks;if(!C.value.trim())return l;const t=C.value.toLowerCase().trim();return l.filter(n=>n.title.toLowerCase().includes(t)||n.agreement.toLowerCase().includes(t))}),g=k(()=>{const l=a.completedTasks;if(!p.value.trim())return l;const t=p.value.toLowerCase().trim();return l.filter(n=>n.title.toLowerCase().includes(t)||n.agreement.toLowerCase().includes(t))}),_=k(()=>{const l=y.value;return h.value.slice(l,l+ee)}),S=k(()=>{const l=v.value;return g.value.slice(l,l+ee)}),d=k(()=>y.value>0),o=k(()=>y.value+ee<h.value.length),T=k(()=>v.value>0),A=k(()=>v.value+ee<g.value.length),M=()=>{$.push({name:"confirmAgreement",query:{mode:"create"}})},E=l=>{$.push(`/task-detail/${l}`)},P=l=>{E(l._id)},H=()=>{d.value&&y.value--},V=()=>{o.value&&y.value++},Y=()=>{T.value&&v.value--},x=()=>{A.value&&v.value++},L=()=>{y.value=0,v.value=0},B=()=>{C.value="",y.value=0},K=()=>{p.value="",v.value=0},ae=()=>{y.value=0},G=()=>{v.value=0},Z=m(new Date),q=["日","一","二","三","四","五","六"];k(()=>{const l=Z.value;return{year:l.getFullYear(),month:l.getMonth()+1,day:l.getDate(),weekDay:l.getDay()}});const oe=k(()=>{const l=Z.value,t=l.getDay(),n=[],I=new Date(l);I.setDate(l.getDate()-t);for(let u=0;u<7;u++){const R=new Date(I);R.setDate(I.getDate()+u),n.push({day:R.getDate(),isToday:R.toDateString()===l.toDateString()})}return n}),F=async()=>{try{console.log("🔄 用户触发下拉刷新"),w.value=1,b.value=!0,L(),await a.fetchAllTasks(),console.log("✅ 下拉刷新完成，任务数量:",a.totalTasks),s.showSuccess("数据已更新")}catch(l){throw console.error("❌ 下拉刷新失败:",l),s.showError("刷新失败，请稍后重试"),a.loadFromLocalStorage(),l}},le=async()=>{try{return await new Promise(l=>setTimeout(l,800)),w.value++,w.value>3?(b.value=!1,s.showInfo("没有更多任务了"),!1):(s.showSuccess("加载完成"),!0)}catch(l){throw s.showError("加载失败"),l}},U=l=>{s.showInfo("按键功能尚未开发")},ne=()=>{s.showInfo("用户功能尚未开发")};return de(async()=>{s.setPageTitle("自律工具 - 任务总览"),s.setCurrentPage("home"),console.log("🏠 首页加载开始"),a.loadFromLocalStorage(),console.log("📦 本地任务数量:",a.totalTasks);try{await a.fetchAllTasks(),console.log("✅ 服务器任务数据已同步，总数量:",a.totalTasks)}catch(l){console.error("❌ 同步服务器数据失败:",l),s.showError("获取最新数据失败，显示本地缓存数据")}}),(l,t)=>(r(),c("div",at,[me(Ue,{class:"home-page-content","can-load-more":b.value,onRefresh:F,onLoadMore:le},{default:fe(()=>[e("main",ot,[e("div",lt,[e("div",{class:"user-welcome-section"},[e("div",{class:"user-avatar",onClick:ne},t[6]||(t[6]=[e("div",{class:"avatar-icon"},"👤",-1)])),t[7]||(t[7]=e("div",{class:"welcome-content"},[e("div",{class:"greeting"},"嗨，Stella。"),e("div",{class:"subtitle"},"开始今天的打卡吧！")],-1))]),e("div",nt,[e("div",rt,[(r(),c(J,null,Q(q,(n,I)=>e("div",{key:I,class:"week-day-header"},N(n),1)),64))]),e("div",it,[(r(!0),c(J,null,Q(oe.value,(n,I)=>(r(),c("div",{key:I,class:z(["calendar-date",{today:n.isToday}])},N(n.day),3))),128))])]),e("section",dt,[e("div",ct,[t[9]||(t[9]=e("h2",{class:"section-title"},[e("img",{src:xe,alt:"未完成",class:"title-icon"}),j(" To-Do ")],-1)),e("div",ut,[ce(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>C.value=n),onInput:ae,type:"text",placeholder:"搜索未完成任务...",class:"search-input"},null,544),[[ue,C.value]]),C.value?(r(),c("button",{key:0,onClick:B,class:"clear-search-btn","aria-label":"清除搜索"}," ✕ ")):D("",!0),t[8]||(t[8]=e("div",{class:"search-icon"},"🔍",-1))])]),e("div",vt,[h.value.length===0?(r(),c("div",ht,[C.value.trim()?(r(),c("div",mt,[t[10]||(t[10]=e("div",{class:"empty-icon"},"🔍",-1)),t[11]||(t[11]=e("h3",null,"没有找到匹配的任务",-1)),t[12]||(t[12]=e("p",null,"尝试使用其他关键词搜索",-1)),e("button",{onClick:B,class:"clear-search-hint"},"清除搜索条件")])):(r(),c("div",ft,t[13]||(t[13]=[e("p",null,"设定第一个自律目标，开始改变自己！",-1)])))])):(r(),c("div",pt,[e("button",{class:"carousel-btn-side prev",disabled:!d.value,onClick:H}," ‹ ",8,gt),e("div",yt,[(r(!0),c(J,null,Q(_.value,n=>(r(),te(ve,{key:n._id,"task-id":n._id,title:n.title,description:n.agreement,"created-at":n.createdAt,"completed-at":n.completedAt,"is-completed":!1,"show-delete-button":!1,"max-title-length":6,onClick:P},null,8,["task-id","title","description","created-at","completed-at"]))),128))]),e("button",{class:"carousel-btn-side next",disabled:!o.value,onClick:V}," › ",8,kt)]))])]),e("section",Ct,[e("div",wt,[t[15]||(t[15]=e("h2",{class:"section-title"},[e("img",{src:Le,alt:"已完成",class:"title-icon"}),j(" Stamped! ")],-1)),e("div",bt,[ce(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>p.value=n),onInput:G,type:"text",placeholder:"搜索已完成任务...",class:"search-input"},null,544),[[ue,p.value]]),p.value?(r(),c("button",{key:0,onClick:K,class:"clear-search-btn","aria-label":"清除搜索"}," ✕ ")):D("",!0),t[14]||(t[14]=e("div",{class:"search-icon"},"🔍",-1))])]),e("div",Tt,[g.value.length===0?(r(),c("div",_t,[p.value.trim()?(r(),c("div",xt,[t[16]||(t[16]=e("div",{class:"empty-icon"},"🔍",-1)),t[17]||(t[17]=e("h3",null,"没有找到匹配的任务",-1)),t[18]||(t[18]=e("p",null,"尝试使用其他关键词搜索",-1)),e("button",{onClick:K,class:"clear-search-hint"},"清除搜索条件")])):(r(),c("div",Lt,t[19]||(t[19]=[e("p",null,"完成任务后，这里会显示你的成就！",-1)])))])):(r(),c("div",$t,[e("button",{class:"carousel-btn-side prev",disabled:!T.value,onClick:Y}," ‹ ",8,Dt),e("div",St,[(r(!0),c(J,null,Q(S.value,n=>(r(),te(ve,{key:n._id,"task-id":n._id,title:n.title,description:n.agreement,"created-at":n.createdAt,"completed-at":n.completedAt,"is-completed":!0,"show-delete-button":!1,"max-title-length":6,onClick:P},null,8,["task-id","title","description","created-at","completed-at"]))),128))]),e("button",{class:"carousel-btn-side next",disabled:!A.value,onClick:x}," › ",8,Mt)]))])])])]),e("button",{class:"fab",onClick:M},t[20]||(t[20]=[e("span",{class:"fab-icon"},null,-1)])),e("div",Pt,[e("div",At,[e("button",{class:"nav-button",onClick:t[2]||(t[2]=n=>U("button1"))}),e("button",{class:"nav-button",onClick:t[3]||(t[3]=n=>U("button2"))})]),e("div",Bt,[e("button",{class:"nav-button",onClick:t[4]||(t[4]=n=>U("button3"))}),e("button",{class:"nav-button",onClick:t[5]||(t[5]=n=>U("button4"))})])])]),_:1},8,["can-load-more"]),f(s).shouldShowToast?(r(),te(He,{key:0,message:f(s).toast.message,type:f(s).toast.type,visible:f(s).toast.visible,onClose:f(s).hideToast},null,8,["message","type","visible","onClose"])):D("",!0)]))}},It=se(Rt,[["__scopeId","data-v-2d0b1860"]]);export{It as default};
