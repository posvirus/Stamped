# 产品需求文档 —— 自律工具应用

## 一、产品概述
一款用于帮助用户提升自律能力的移动端应用，用户可以创建目标并生成协议，协议的完成由用户提交材料进行验证，结果由AI判定。

---

## 二、核心功能
1. **目标创建和协议生成**
   - 用户可以输入目标描述，调用AI生成一个清晰可验证的协议。
   - 用户确认协议后，目标和协议保存至“未完成任务”数据库。

2. **任务总览**
   - 在任务总览界面中显示未完成任务和已完成任务分类列表，支持点击查看任务详情。

3. **任务验证**
   - 用户选择未完成任务，提交验证材料（文字、图片），调用AI API验证，并返回置信度结果。
   - 若置信度达到设定值，标记任务为完成，并转移至已完成任务数据库。

4. **任务记录**
   - 已完成的任务会存储在已完成任务数据库中供用户查看。

---

## 三、页面设计

### 1. 首页（任务总览页面）
#### 功能
- 展示未完成任务和已完成任务。
- 支持查看任务详情。
- 提供创建新目标的入口。

#### UI布局
- **顶部导航栏**：
  - 左侧显示应用名称（简洁文字，如“自律工具”）。
  - 右侧占位设置按钮（功能暂不实现）。
  
- **任务分类Tab切换**：
  - 两个标签，分别为“未完成任务”和“已完成任务”。
  - 默认显示“未完成任务”。
  
- **任务列表**：
  - 每个任务以卡片形式展示，显示任务标题（目标描述的前20个字符）和创建日期。
  - 点击卡片进入任务详情。
  
- **底部浮动操作按钮**：
  - 圆形带“+”图标的浮动按钮，点击进入创建新目标页面。

---

### 2. 创建目标页面
#### 功能
- 输入目标描述。
- 调用AI接口生成验证协议。
- 确认协议后保存目标和协议。

#### UI布局
- **输入目标**：
  - 占位文字：“请输入你的目标描述……”
  - 支持多行文本输入。

- **生成协议按钮**：
  - 用户完成输入后点击按钮调用AI生成协议。

---

### 3. 协议确认页面
#### 功能
- 显示用户输入的目标及AI生成协议。
- 用户可以确认协议并保存任务。

#### UI布局
- **目标内容展示**：
  - 用户输入的目标文本。
  
- **协议内容展示**：
  - AI生成的协议文本（支持滚动查看）。
  
- **操作按钮**：
  - 左按钮：“重新生成协议”（重新调用AI生成）。
  - 右按钮：“确认协议并保存”（保存任务至未完成任务数据库）。

---

### 4. 任务详情页面（未完成任务/已完成任务）
#### 功能
- 显示目标和协议详情。
- 未完成任务支持跳转至验证页面。

#### UI布局
- **目标和协议展示**：
  - 目标标题、目标描述。
  - 协议文本（支持滚动查看）。
  
- **操作按钮**（仅未完成任务显示）：
  - 固定在底部的“验证任务”按钮，点击后进入验证页面。

---

### 5. 任务验证页面
#### 功能
- 上传材料（文字说明和图片）验证目标完成情况。
- 调用AI接口返回置信度，提示验证结果。

#### UI布局
- **目标与协议折叠面板**：
  - 默认折叠，用户可展开查看目标和协议内容。
  
- **验证材料上传**：
  - 文字输入框：“请描述你的完成情况……”
  - 图片上传按钮（支持一次上传多张图片，最多3张）。
  
- **验证操作**：
  - 提交验证按钮，调用AI接口验证。
  
- **验证结果**：
  - 若置信度达标，任务完成，弹出绿色提示“任务完成！”，并返回首页。
  - 若未达标，提示灰色信息“未完成+[具体原因]”，停留在当前页面。

---

## 四、UI元素设计
### 颜色规范
- **主色调**：蓝色（#1E88E5）。
- **成功色**：绿色（#43A047）。
- **背景色**：浅灰色（#F5F5F5）。
- **字体颜色**：深灰色（#212121）。

### 按钮样式
- **主按钮**：圆角矩形，蓝色填充，白色文字。
- **次按钮**：蓝色边框，白色背景，蓝色文字。
- **浮动按钮**：圆形，直径56px，蓝色填充，白色加号。

### 输入框
- 圆角矩形，浅灰边框，48px高度。

### 任务卡片
- 白色背景，轻阴影，内边距16px，边角圆润。

---

## 五、技术栈
### 前端
- **框架**：Vue 3
- **路由**：Vue Router
- **状态管理**：Pinia
- **构建工具**：Vite
- **样式**：纯CSS
- **数据请求**：Axios

### 后端
- **运行时环境**：Node.js
- **数据库**：MongoDB

---

## 六、数据库设计
- **未完成任务集合（`tasks`）**
  ```json
  {
    "_id": "ObjectId",
    "title": "用户输入的目标描述",
    "agreement": "AI生成的协议内容",
    "createdAt": "Date",
    "status": "pending" // 区分进行中和已完成状态
  }
  ```
- **已完成任务集合（`completed_tasks`）**
  ```json
  {
    "_id": "ObjectId",
    "title": "用户输入的目标描述",
    "agreement": "AI生成的协议内容",
    "createdAt": "Date",
    "completedAt": "Date"
  }
  ```

---

## 七、API接口设计
1. **创建任务**
   - `POST /api/task`
   - 请求数据：目标描述
   - 返回数据：AI生成的协议

2. **获取任务列表**
   - `GET /api/tasks?status=pending（进行中）或 completed（已完成）`

3. **验证任务**
   - `POST /api/task/:id/verify`
   - 请求数据：目标描述、协议、文字说明、图片文件。
   - 返回数据：置信度结果。

---

## 八、交互流程概述
1. 用户在首页点击“+”按钮进入创建目标页面。
2. 用户输入目标描述，生成验证协议，确认协议后保存任务。
3. 用户在任务总览中选择一项未完成任务，进入任务详情页面。
4. 在任务详情页面中点击“验证任务”，上传验证材料提交验证。
5. 验证完成后任务从未完成转移至已完成，更新任务总览页面。

---

## 九、功能限制
- 不支持用户系统（单设备单用户使用）。
- 数据仅在当前设备上存储，未设计多设备同步功能。
